{
  "code": "import WxApi from \"../Libs/WxApi\";\r\nexport default class RecorderMgr {\r\n    constructor() {\r\n        this.isRecording = false;\r\n        this.recorder = null;\r\n        this.videoPath = '';\r\n    }\r\n    static get instance() {\r\n        if (!this._instance) {\r\n            this._instance = new RecorderMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n    initRecorder() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            this.recorder = window['tt'].getGameRecorderManager();\r\n            this.onStopListener();\r\n            this.onInterrupBegin();\r\n            this.onInterrupEnd();\r\n        }\r\n    }\r\n    recordStart() {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        console.log('录屏开始');\r\n        this.recorder.start({\r\n            duration: 300,\r\n        });\r\n        this.isRecording = true;\r\n    }\r\n    recordPause() {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        console.log('录屏暂停');\r\n        this.recorder.pause();\r\n    }\r\n    recordResume() {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        console.log('录屏继续');\r\n        this.recorder.resume();\r\n    }\r\n    recordStop() {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        if (!this.isRecording) {\r\n            return;\r\n        }\r\n        console.log('录屏停止');\r\n        this.recorder.stop();\r\n    }\r\n    onStopListener() {\r\n        this.recorder.onStop(res => {\r\n            console.log('录屏结束：', res.videoPath);\r\n            this.videoPath = res.videoPath;\r\n            this.isRecording = false;\r\n        });\r\n    }\r\n    shareVideo(cb) {\r\n        if (this.videoPath == '') {\r\n            WxApi.OpenAlert('请开始游戏录制视频！');\r\n            return;\r\n        }\r\n        window['tt'].shareAppMessage({\r\n            channel: 'video',\r\n            extra: {\r\n                videoPath: this.videoPath,\r\n                videoTopics: [\"我画你杀\", \"抖音小游戏\"],\r\n                hashtag_list: [\"我画你杀\", \"抖音小游戏\"],\r\n                createChallenge: true,\r\n                withVideoId: true\r\n            },\r\n            success: () => {\r\n                console.log(\"分享成功\");\r\n                cb && cb();\r\n            },\r\n            fail: (e) => {\r\n                console.log(\"分享失败\");\r\n                WxApi.OpenAlert('分享失败！');\r\n            }\r\n        });\r\n    }\r\n    onInterrupBegin() {\r\n        this.recorder.onInterruptionBegin(() => {\r\n            console.log('录屏被打断开始');\r\n            this.recordPause();\r\n        });\r\n    }\r\n    onInterrupEnd() {\r\n        this.recorder.onInterruptionEnd(() => {\r\n            console.log('录屏被打断结束');\r\n            this.recordResume();\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeaponTT/src/Libs/WxApi.ts"
  ]
}
