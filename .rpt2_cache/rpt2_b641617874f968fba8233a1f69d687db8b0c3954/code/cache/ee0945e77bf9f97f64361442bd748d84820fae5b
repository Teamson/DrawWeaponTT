{
  "code": "export class PlayerData {\r\n    constructor() {\r\n        this.grade = 1;\r\n        this.gradeIndex = 0;\r\n        this.power = 10;\r\n        this.playerCountLv = 1;\r\n        this.playerPowerLv = 1;\r\n        this.playerOfflineLv = 1;\r\n        this.coin = 9999;\r\n        this.playerId = 0;\r\n        this.playerArr = [];\r\n        this.unlockSkinCount = 0;\r\n        this.exitTime = 0;\r\n    }\r\n}\r\nexport default class PlayerDataMgr {\r\n    static getPlayerData() {\r\n        if (!localStorage.getItem('playerData')) {\r\n            this._playerData = new PlayerData();\r\n            for (let i = 0; i < 27; i++) {\r\n                if (i == 0) {\r\n                    this._playerData.playerArr.push(0);\r\n                }\r\n                else {\r\n                    this._playerData.playerArr.push(-1);\r\n                }\r\n            }\r\n            localStorage.setItem('playerData', JSON.stringify(this._playerData));\r\n        }\r\n        else {\r\n            if (this._playerData == null) {\r\n                this._playerData = JSON.parse(localStorage.getItem('playerData'));\r\n            }\r\n        }\r\n        return this._playerData;\r\n    }\r\n    static setPlayerData() {\r\n        localStorage.setItem('playerData', JSON.stringify(this._playerData));\r\n    }\r\n    static getPlayerYet() {\r\n        let arr = [];\r\n        for (let i = 0; i < this._playerData.playerArr.length; i++) {\r\n            if (this._playerData.playerArr[i] < 0) {\r\n                arr.push(i);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    static getCoinSkins() {\r\n        let idArr = [].concat(this.skinArr1);\r\n        let arr = [];\r\n        for (let i = 0; i < idArr.length; i++) {\r\n            if (this._playerData.playerArr[i] < 0) {\r\n                arr.push(idArr[i]);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    static getVideoSkins() {\r\n        let idArr = [].concat(this.skinArr2);\r\n        let arr = [];\r\n        for (let i = 0; i < idArr.length; i++) {\r\n            if (this._playerData.playerArr[i + 9] < 0) {\r\n                arr.push(idArr[i]);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    static getBoxSkins() {\r\n        let idArr = [].concat(this.skinArr3);\r\n        let arr = [];\r\n        for (let i = 0; i < idArr.length; i++) {\r\n            if (this._playerData.playerArr[i + 18] < 0) {\r\n                arr.push(idArr[i]);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    static changeCoin(dt) {\r\n        this._playerData.coin += dt;\r\n        this.setPlayerData();\r\n    }\r\n    static getPlayerSkin(id, value) {\r\n        this._playerData.playerArr[id] = value;\r\n        this._playerData.playerId = value;\r\n        this.setPlayerData();\r\n    }\r\n    static getPlayerCountLv() {\r\n        return this._playerData.playerCountLv;\r\n    }\r\n    static upgradePlayerCountLv() {\r\n        if (this._playerData.playerCountLv >= 5) {\r\n            return;\r\n        }\r\n        this._playerData.playerCountLv += 1;\r\n        this.setPlayerData();\r\n    }\r\n    static getPlayerCount() {\r\n        return this._playerData.playerCountLv;\r\n    }\r\n    static getPlayerPowerLv() {\r\n        return this._playerData.playerPowerLv;\r\n    }\r\n    static upgradePlayerPowerLv() {\r\n        if (this._playerData.playerPowerLv >= 35) {\r\n            return;\r\n        }\r\n        this._playerData.playerPowerLv += 1;\r\n        this.setPlayerData();\r\n    }\r\n    static getPlayerPowerData() {\r\n        let data = {\r\n            hp: 100,\r\n            atk: 20\r\n        };\r\n        data.hp = 100 + 4 * (this._playerData.playerPowerLv - 1);\r\n        data.atk = 20 + 2 * (this._playerData.playerPowerLv - 1);\r\n        return data;\r\n    }\r\n    static getPlayerOfflineLv() {\r\n        return this._playerData.playerOfflineLv;\r\n    }\r\n    static upgradePlayerOfflineLv() {\r\n        if (this._playerData.playerOfflineLv >= 56) {\r\n            return;\r\n        }\r\n        this._playerData.playerOfflineLv += 1;\r\n        this.setPlayerData();\r\n    }\r\n    static getPlayerOffline(min) {\r\n        return Math.floor(min * (1 + 0.05 * (this._playerData.playerOfflineLv - 1)));\r\n    }\r\n    static getNpcData() {\r\n        let data = {\r\n            hp: 100,\r\n            atk: 10\r\n        };\r\n        data.hp = 100 + 10 * (this._playerData.grade - 1);\r\n        data.atk = 10 + 5 * (this._playerData.grade - 1);\r\n        if (data.hp > 240) {\r\n            data.hp = 240;\r\n        }\r\n        if (data.atk > 90) {\r\n            data.atk = 90;\r\n        }\r\n        return data;\r\n    }\r\n    static getUpgradePlayerCountLvCost() {\r\n        let cost = 100;\r\n        let lv = this.getPlayerCountLv();\r\n        cost = 100 + 500 * (lv - 1);\r\n        return cost;\r\n    }\r\n    static getUpgradePlayerPowerLvCost() {\r\n        let cost = 50;\r\n        let lv = this.getPlayerPowerLv();\r\n        cost = 50 + 50 * (lv - 1);\r\n        return cost;\r\n    }\r\n    static getUpgradeOfflineLvCost() {\r\n        let cost = 50;\r\n        let lv = this.getPlayerOfflineLv();\r\n        cost = 50 + 50 * (lv - 1);\r\n        return cost;\r\n    }\r\n    static getUnlockSkinCost() {\r\n        return 100 + (100 * this._playerData.unlockSkinCount);\r\n    }\r\n    static getHeroSkinDir(id) {\r\n        return 'heroSkins/Hero_' + (id + 1) + '.png';\r\n    }\r\n    static setExitTime() {\r\n        this._playerData.exitTime = new Date().getTime();\r\n        this.setPlayerData();\r\n    }\r\n}\r\nPlayerDataMgr._playerData = null;\r\nPlayerDataMgr.tempSkinId = -1;\r\nPlayerDataMgr.aiConfig = null;\r\nPlayerDataMgr.skinArr1 = [0, 1, 2];\r\nPlayerDataMgr.skinArr2 = [3, 4];\r\nPlayerDataMgr.skinArr3 = [5, 6, 7];\r\nPlayerDataMgr.skinArr4 = [8, 9];\r\n",
  "references": []
}
