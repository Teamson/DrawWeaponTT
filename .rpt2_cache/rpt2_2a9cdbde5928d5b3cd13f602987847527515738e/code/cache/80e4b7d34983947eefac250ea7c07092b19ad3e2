{
  "code": "import PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport GameLogic from \"../Crl/GameLogic\";\r\nimport Utility from \"../Mod/Utility\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nimport AdMgr from \"../Mod/AdMgr\";\r\nimport RecorderMgr from \"../Mod/RecorderMgr\";\r\nexport default class FreeSkinUI extends Laya.Scene {\r\n    constructor() {\r\n        super();\r\n        this.closeBtn = this['closeBtn'];\r\n        this.itemNode = this['itemNode'];\r\n        this.randBtn = this['randBtn'];\r\n        this.videoTG = this['videoTG'];\r\n        this.tgBtn = this['tgBtn'];\r\n        this.skinArr = [];\r\n        this.randTGNum = 3;\r\n        this.tgCount = 0;\r\n        this.tempRandNum = 3;\r\n        this.isChick = false;\r\n    }\r\n    onOpened(param) {\r\n        this.closeBtn.on(Laya.Event.CLICK, this, this.closeBtnCB);\r\n        this.randBtn.on(Laya.Event.CLICK, this, this.randBtnCB);\r\n        this.tgBtn.on(Laya.Event.CLICK, this, this.toggleCB);\r\n        this.skinArr = PlayerDataMgr.getFreeSkins();\r\n        this.tempRandNum = Utility.GetRandom(1, 3);\r\n        this.randTGNum = this.tempRandNum;\r\n        this.getIsChick();\r\n        this.initData();\r\n        AdMgr.instance.showBanner();\r\n        this.changeCloseLabel();\r\n    }\r\n    onClosed() {\r\n        RecorderMgr.instance.recordResume();\r\n        AdMgr.instance.hideBanner();\r\n    }\r\n    getIsChick() {\r\n        if (PlayerDataMgr.getPlayerData().grade <= 2) {\r\n            this.isChick = false;\r\n        }\r\n        else if (PlayerDataMgr.getPlayerData().grade == 3 || PlayerDataMgr.getPlayerData().grade == 4) {\r\n            this.isChick = true;\r\n        }\r\n        else {\r\n            this.isChick = Math.floor(PlayerDataMgr.getPlayerData().grade % 2) == 0;\r\n        }\r\n    }\r\n    initData() {\r\n        let icon = this['icon'];\r\n        icon.skin = 'freeSkins/HeroD_' + (this.skinArr[0] + 1) + '.png';\r\n    }\r\n    itemCB(id) {\r\n        PlayerDataMgr.freeSkinId = id;\r\n        GameLogic.Share.changePlayerSkin(id);\r\n    }\r\n    randBtnCB() {\r\n        WxApi.ttEvent('Event_10');\r\n        let cb = () => {\r\n            WxApi.ttEvent('Event_11');\r\n            let id = Utility.getRandomItemInArr(this.skinArr);\r\n            this.itemCB(id);\r\n            this.closeCB();\r\n        };\r\n        AdMgr.instance.showVideo(cb);\r\n    }\r\n    closeBtnCB() {\r\n        let isBounes = this.videoTG.selected;\r\n        isBounes = this.isChick ? !isBounes : isBounes;\r\n        if (isBounes) {\r\n            this.randBtnCB();\r\n        }\r\n        else {\r\n            this.closeCB();\r\n        }\r\n    }\r\n    closeCB() {\r\n        Laya.Scene.close('MyScenes/FreeSkinUI.scene');\r\n        GameLogic.Share.canReady = true;\r\n        GameLogic.Share.readyGo();\r\n    }\r\n    toggleCB() {\r\n        if (this.videoTG.selected) {\r\n            this.tgCount++;\r\n            if (this.tgCount > this.randTGNum) {\r\n                this.tgCount = 0;\r\n                this.randTGNum = this.tempRandNum;\r\n                this.videoTG.selected = false;\r\n            }\r\n        }\r\n        else {\r\n            this.videoTG.selected = true;\r\n        }\r\n        this.changeCloseLabel();\r\n    }\r\n    changeCloseLabel() {\r\n        if (this.isChick) {\r\n            this.closeBtn.skin = this.videoTG.selected ? 'TTRes/dy-sm2.png' : 'TTRes/dy-sm4.png';\r\n            this['tgTips'].skin = this.videoTG.selected ? 'TTRes/dy-wz4.png' : 'TTRes/dy-wz.png';\r\n        }\r\n        else {\r\n            this.closeBtn.skin = this.videoTG.selected ? 'TTRes/dy-sm4.png' : 'TTRes/dy-sm2.png';\r\n            this['tgTips'].skin = this.videoTG.selected ? 'TTRes/dy-wz.png' : 'TTRes/dy-wz4.png';\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeaponTT/src/Libs/PlayerDataMgr.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Crl/GameLogic.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/Utility.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/ShareMgr.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Libs/WxApi.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/AdMgr.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/RecorderMgr.ts"
  ]
}
