{
  "code": "import Utility from \"../Mod/Utility\";\r\nimport GameLogic from \"../Crl/GameLogic\";\r\nexport default class GameUI extends Laya.Scene {\r\n    constructor() {\r\n        super();\r\n        this.touchPanel = this['touchPanel'];\r\n        this.touchNode = this['touchNode'];\r\n        this.drawSp = this['drawSp'];\r\n        this.touchStarted = false;\r\n        this.startPos = null;\r\n        this.lineArr = [];\r\n        this.lineArrVec2 = [];\r\n        this.canTouch = false;\r\n    }\r\n    onOpened(param) {\r\n        this.initData();\r\n    }\r\n    onClosed() {\r\n    }\r\n    initData() {\r\n        this.touchPanel.y = Utility.fixPosY(this.touchPanel.y);\r\n        this.touchNode.on(Laya.Event.MOUSE_DOWN, this, this.touchStart);\r\n        this.touchNode.on(Laya.Event.MOUSE_MOVE, this, this.touchMove);\r\n        this.touchNode.on(Laya.Event.MOUSE_UP, this, this.touchEnd);\r\n        this.canTouch = true;\r\n    }\r\n    touchStart(event) {\r\n        if (!this.safeArea(new Laya.Vector2(event.stageX, event.stageY)) || !this.canTouch) {\r\n            return;\r\n        }\r\n        this.touchStarted = true;\r\n        this.startPos = new Laya.Vector2(event.stageX, event.stageY);\r\n        this.lineArr = [];\r\n        this.lineArr.push(this.startPos.x);\r\n        this.lineArr.push(this.startPos.y);\r\n        this.lineArrVec2 = [];\r\n        this.lineArrVec2.push(this.startPos);\r\n    }\r\n    touchMove(event) {\r\n        if (!this.safeArea(new Laya.Vector2(event.stageX, event.stageY)) || !this.touchStarted) {\r\n            return;\r\n        }\r\n        let p = new Laya.Vector2(event.stageX, event.stageY);\r\n        let dis = Utility.calcDistance(this.startPos, p);\r\n        if (dis >= 10 && this.lineArrVec2.length < GameLogic.WEAPON_LENGTH) {\r\n            this.lineArr.push(p.x);\r\n            this.lineArr.push(p.y);\r\n            this.lineArrVec2.push(p);\r\n            this.startPos = p;\r\n            this.drawLine();\r\n        }\r\n    }\r\n    touchEnd(event) {\r\n        if (!this.touchStarted) {\r\n            return;\r\n        }\r\n        this.touchStarted = false;\r\n        this.drawSp.graphics.clear();\r\n        GameLogic.Share.createLine3D(this.lineArrVec2);\r\n    }\r\n    drawLine() {\r\n        this.drawSp.graphics.clear();\r\n        this.drawSp.graphics.drawLines(0, 0, this.lineArr, \"#ff0000\", 3);\r\n    }\r\n    safeArea(pos) {\r\n        let x1 = this.touchPanel.x - this.touchPanel.width / 2;\r\n        let x2 = this.touchPanel.x + this.touchPanel.width / 2;\r\n        let y1 = this.touchPanel.y - this.touchPanel.height / 2;\r\n        let y2 = this.touchPanel.y + this.touchPanel.height / 2;\r\n        if (pos.x < x1 || pos.x > x2 || pos.y < y1 || pos.y > y2) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeapon/src/Mod/Utility.ts",
    "E:/LayaProjects/DrawWeapon/src/Crl/GameLogic.ts"
  ]
}
