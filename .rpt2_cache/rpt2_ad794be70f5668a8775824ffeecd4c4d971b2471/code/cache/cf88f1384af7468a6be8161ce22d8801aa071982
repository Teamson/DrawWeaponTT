{
  "code": "import PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport GameLogic from \"../Crl/GameLogic\";\r\nimport Utility from \"../Mod/Utility\";\r\nimport AdMgr from \"../Mod/AdMgr\";\r\nexport default class FreeSkinUI extends Laya.Scene {\r\n    constructor() {\r\n        super();\r\n        this.closeBtn = this['closeBtn'];\r\n        this.itemNode = this['itemNode'];\r\n        this.randBtn = this['randBtn'];\r\n        this.videoTG = this['videoTG'];\r\n        this.tgBtn = this['tgBtn'];\r\n        this.skinArr = [];\r\n        this.randTGNum = 3;\r\n        this.tgCount = 0;\r\n    }\r\n    onOpened(param) {\r\n        this.closeBtn.on(Laya.Event.CLICK, this, this.closeBtnCB);\r\n        this.randBtn.on(Laya.Event.CLICK, this, this.randBtnCB);\r\n        this.tgBtn.on(Laya.Event.CLICK, this, this.toggleCB);\r\n        this.skinArr = PlayerDataMgr.getFreeSkins();\r\n        this.randTGNum = Utility.GetRandom(1, 3);\r\n        this.initData();\r\n        AdMgr.instance.showBanner();\r\n    }\r\n    onClosed() {\r\n        AdMgr.instance.hideBanner();\r\n    }\r\n    initData() {\r\n        let icon = this['icon'];\r\n        icon.skin = 'freeSkins/HeroD_' + (this.skinArr[0] + 1) + '.png';\r\n    }\r\n    itemCB(id) {\r\n        PlayerDataMgr.freeSkinId = id;\r\n        GameLogic.Share.changePlayerSkin(id);\r\n    }\r\n    randBtnCB() {\r\n        let cb = () => {\r\n            let id = Utility.getRandomItemInArr(this.skinArr);\r\n            this.itemCB(id);\r\n            this.closeCB();\r\n        };\r\n        AdMgr.instance.showVideo(cb);\r\n    }\r\n    closeBtnCB() {\r\n        if (this.videoTG.selected) {\r\n            this.randBtnCB();\r\n        }\r\n        else {\r\n            this.closeCB();\r\n        }\r\n    }\r\n    closeCB() {\r\n        Laya.Scene.close('MyScenes/FreeSkinUI.scene');\r\n        GameLogic.Share.canReady = true;\r\n        GameLogic.Share.readyGo();\r\n    }\r\n    toggleCB() {\r\n        if (this.videoTG.selected) {\r\n            this.tgCount++;\r\n            if (this.tgCount > this.randTGNum) {\r\n                this.tgCount = 0;\r\n                this.randTGNum = Utility.GetRandom(1, 3);\r\n                this.videoTG.selected = false;\r\n                AdMgr.instance.showVideo(() => { });\r\n            }\r\n        }\r\n        else {\r\n            this.videoTG.selected = true;\r\n        }\r\n        this.changeCloseLabel();\r\n    }\r\n    changeCloseLabel() {\r\n        this.closeBtn.skin = this.videoTG.selected ? 'TTRes/dy-sm4.png' : 'TTRes/dy-sm2.png';\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeaponTT/src/Libs/PlayerDataMgr.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Crl/GameLogic.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/Utility.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/ShareMgr.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Libs/WxApi.ts",
    "E:/LayaProjects/DrawWeaponTT/src/Mod/AdMgr.ts"
  ]
}
