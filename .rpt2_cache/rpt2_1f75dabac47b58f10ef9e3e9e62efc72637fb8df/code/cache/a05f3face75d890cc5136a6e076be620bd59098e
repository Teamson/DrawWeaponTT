{
  "code": "import PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport GameLogic from \"../Crl/GameLogic\";\r\nimport ShareMgr from \"../Mod/ShareMgr\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nimport JJMgr, { SceneDir } from \"../JJExport/Common/JJMgr\";\r\nimport AdMgr from \"../Mod/AdMgr\";\r\nexport default class FinishUI extends Laya.Scene {\r\n    constructor() {\r\n        super();\r\n        this.openBoxBtn = this['openBoxBtn'];\r\n        this.videoBtn = this['videoBtn'];\r\n        this.noBtn = this['noBtn'];\r\n        this.bounes = this['bounes'];\r\n        this.boxBtnEnabled = true;\r\n    }\r\n    onOpened(param) {\r\n        WxApi.aldEvent('第' + PlayerDataMgr.getPlayerData().grade + '关：通关');\r\n        this.initData();\r\n        JJMgr.instance.openScene(SceneDir.SCENE_FINISHGAMEUI, false, { posY: 600, fixY: true });\r\n        AdMgr.instance.hideBanner();\r\n        JJMgr.instance.closeScene(SceneDir.SCENE_DRAWUI);\r\n    }\r\n    onClosed() {\r\n        AdMgr.instance.hideBanner();\r\n    }\r\n    initData() {\r\n        this.openBoxBtn.on(Laya.Event.CLICK, this, this.openBoxCB);\r\n        this.videoBtn.on(Laya.Event.CLICK, this, this.videoBtnCB);\r\n        this.noBtn.on(Laya.Event.CLICK, this, this.noBtnCB);\r\n        let grade = PlayerDataMgr.getPlayerData().grade - 1;\r\n        let g = Math.floor(grade % 4) == 0 ? 4 : Math.floor(grade % 4);\r\n        this.bounes.skin = g == 4 ? 'finishUI/js-bx.png' : 'finishUI/js-ys.png';\r\n        this.openBoxBtn.visible = g == 4;\r\n        this.videoBtn.visible = g != 4;\r\n        this.noBtn.visible = g != 4;\r\n        if (this.noBtn.visible)\r\n            WxApi.fixBtnTouchPos(this.noBtn, 300, 100, this);\r\n        else {\r\n            this.boxBtnEnabled = false;\r\n            WxApi.fixBtnTouchPos(this.openBoxBtn, 300, 0, this, () => { this.boxBtnEnabled = true; });\r\n        }\r\n        GameLogic.Share.isHelpStart = false;\r\n        GameLogic.Share.gradeIndex = 0;\r\n        PlayerDataMgr.getPlayerData().gradeIndex = 0;\r\n        PlayerDataMgr.setPlayerData();\r\n    }\r\n    openBoxCB() {\r\n        if (!this.boxBtnEnabled)\r\n            return;\r\n        Laya.Scene.open('MyScenes/BoxUI.scene');\r\n    }\r\n    videoBtnCB() {\r\n        WxApi.aldEvent('视频/分享打开宝箱：点击');\r\n        let cb = () => {\r\n            WxApi.aldEvent('视频/分享打开宝箱：成功');\r\n            Laya.Scene.open('MyScenes/BoxUI.scene');\r\n        };\r\n        ShareMgr.instance.shareGame(cb);\r\n    }\r\n    noBtnCB() {\r\n        this.close();\r\n        JJMgr.instance.closeScene(SceneDir.SCENE_FINISHGAMEUI);\r\n        JJMgr.instance.openScene(SceneDir.SCENE_FULLGAMEUI, false, {\r\n            grade: PlayerDataMgr.getPlayerData().grade,\r\n            continueCallbackFun: () => {\r\n                Laya.Scene.open('MyScenes/GameUI.scene', false, () => { GameLogic.Share.restartGame(); });\r\n            }\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeapon/src/Libs/PlayerDataMgr.ts",
    "E:/LayaProjects/DrawWeapon/src/Crl/GameLogic.ts",
    "E:/LayaProjects/DrawWeapon/src/Mod/ShareMgr.ts",
    "E:/LayaProjects/DrawWeapon/src/Libs/WxApi.ts",
    "E:/LayaProjects/DrawWeapon/src/JJExport/Common/JJMgr.ts",
    "E:/LayaProjects/DrawWeapon/src/Mod/AdMgr.ts"
  ]
}
