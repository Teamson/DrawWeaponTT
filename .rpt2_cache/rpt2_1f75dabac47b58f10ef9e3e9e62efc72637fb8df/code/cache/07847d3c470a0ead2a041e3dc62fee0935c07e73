{
  "code": "import Utility from \"../Mod/Utility\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nimport PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nexport default class SkinUIPlayer extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.myOwner = null;\r\n        this._ani = null;\r\n        this.weaponNode = null;\r\n        this.embNode = null;\r\n        this.embScale = null;\r\n        this.embPos = null;\r\n        this.embRotation = null;\r\n    }\r\n    onAwake() {\r\n        this.myOwner = this.owner;\r\n        this._ani = this.owner.getComponent(Laya.Animator);\r\n        this.playIdle1();\r\n        this.weaponNode = Utility.findNodeByName(this.myOwner, 'Dummy_Arms');\r\n        this.embNode = Utility.findNodeByName(this.myOwner, 'Dummy_Emb');\r\n        let emb = Utility.findNodeByName(this.myOwner, 'Hero1_Emb');\r\n        this.embScale = emb.transform.localScale.clone();\r\n        this.embPos = emb.transform.localPosition.clone();\r\n        this.embRotation = emb.transform.localRotation.clone();\r\n        this.changeSkin(PlayerDataMgr.getPlayerData().playerId);\r\n    }\r\n    onDisable() {\r\n    }\r\n    playIdle1() {\r\n        this._ani.crossFade(\"walk\", 0.05);\r\n        this._ani.crossFade(\"hit\", 0.05, 1);\r\n    }\r\n    changeSkin(id) {\r\n        let mats = new Laya.UnlitMaterial();\r\n        Laya.Texture2D.load('res/skinHero/HeroD_' + (id + 1) + '.png', Laya.Handler.create(this, function (tex) {\r\n            mats.albedoTexture = tex;\r\n        }));\r\n        for (let i = 1; i <= 4; i++) {\r\n            let mesh3d = this.owner.getChildAt(i);\r\n            mesh3d.skinnedMeshRenderer.material = mats;\r\n        }\r\n        this.embNode.destroyChildren();\r\n        let embRes = Laya.loader.getRes(WxApi.UnityPath + 'Hero' + (id + 1) + '_Emb.lh');\r\n        let emb = Laya.Sprite3D.instantiate(embRes, this.embNode, false, new Laya.Vector3(0, 0, 0));\r\n        emb.transform.localScale = this.embScale;\r\n        emb.transform.localPosition = this.embPos;\r\n        emb.transform.localRotation = this.embRotation;\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeapon/src/Mod/Utility.ts",
    "E:/LayaProjects/DrawWeapon/src/Libs/WxApi.ts",
    "E:/LayaProjects/DrawWeapon/src/Libs/PlayerDataMgr.ts"
  ]
}
