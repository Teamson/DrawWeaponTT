{
  "code": "import WxApi from \"../Libs/WxApi\";\r\nconst LINE_GAP = 0.1;\r\nexport default class GameLogic {\r\n    constructor() {\r\n        this._playerNode = new Laya.Sprite3D();\r\n        GameLogic.Share = this;\r\n        Laya.Scene.open('MyScenes/LoadingUI.scene');\r\n    }\r\n    loadAtlas() {\r\n    }\r\n    initScene() {\r\n        Laya.Scene3D.load(WxApi.UnityPath + 'MyScene.ls', Laya.Handler.create(this, this.onLoadScene));\r\n    }\r\n    onLoadScene(scene) {\r\n        this._scene = Laya.stage.addChild(scene);\r\n        Laya.stage.setChildIndex(this._scene, 0);\r\n        this._scene.addChild(this._playerNode);\r\n        this.createPlayer();\r\n    }\r\n    createPlayer() {\r\n        let playerRes = Laya.loader.getRes(WxApi.UnityPath + 'player.lh');\r\n        let sx = 1;\r\n        for (let i = 0; i < 3; i++) {\r\n            let player = Laya.Sprite3D.instantiate(playerRes, this._playerNode, false, new Laya.Vector3(0, 0.5, 0));\r\n            player.transform.localPosition.x = sx;\r\n            sx -= 1;\r\n        }\r\n    }\r\n    createLine3D(lineArr) {\r\n        let lineNode = new Laya.Sprite3D();\r\n        let lineRes = Laya.loader.getRes(WxApi.UnityPath + 'line.lh');\r\n        let bottomPos = new Laya.Vector3(0, 0, 0);\r\n        for (let i = 0; i < lineArr.length; i++) {\r\n            if (i == 0) {\r\n                let line = Laya.Sprite3D.instantiate(lineRes, lineNode, false, new Laya.Vector3(0, 0, 0));\r\n                line.transform.position = new Laya.Vector3(0, 0, 0);\r\n                bottomPos = line.transform.position.clone();\r\n            }\r\n            else {\r\n                let p1 = new Laya.Vector3(-lineArr[i - 1].x, 0, -lineArr[i - 1].y);\r\n                let p2 = new Laya.Vector3(-lineArr[i].x, 0, -lineArr[i].y);\r\n                let preL = lineNode.getChildAt(lineNode.numChildren - 1);\r\n                let prePos = preL.transform.position.clone();\r\n                let dis = Laya.Vector3.distance(p1, p2);\r\n                for (let j = 0; j < Math.floor(dis / 5); j++) {\r\n                    let line = Laya.Sprite3D.instantiate(lineRes, lineNode, false, new Laya.Vector3(0, 0, 0));\r\n                    let dir = new Laya.Vector3(0, 0, 0);\r\n                    Laya.Vector3.subtract(p2, p1, dir);\r\n                    Laya.Vector3.normalize(dir, dir);\r\n                    let d = (LINE_GAP * (j + 1));\r\n                    dir = new Laya.Vector3(dir.x * d, dir.y * d, dir.z * d);\r\n                    let pos = new Laya.Vector3(0, 0, 0);\r\n                    Laya.Vector3.add(prePos, dir, pos);\r\n                    line.transform.position = pos;\r\n                    if (line.transform.position.z < bottomPos.z) {\r\n                        bottomPos = line.transform.position.clone();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let i = 0; i < lineNode.numChildren; i++) {\r\n            let node = lineNode.getChildAt(i);\r\n            let p = new Laya.Vector3(0, 0, 0);\r\n            Laya.Vector3.subtract(node.transform.position, bottomPos, p);\r\n            node.transform.position = p;\r\n        }\r\n        let player = this._playerNode.getChildAt(0);\r\n        let weaponNode = player.getChildByName('weaponNode');\r\n        weaponNode.addChild(lineNode);\r\n        lineNode.transform.localPosition = new Laya.Vector3(0, 0, 0);\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/DrawWeapon/src/Libs/WxApi.ts"
  ]
}
